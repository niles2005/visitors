<!doctype html>
<html ng-app>
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="css/bootstrap.css"/>
        <script src="scripts/angular.js"></script>
        <script>
            function BindState($scope, $http) {
                $scope.doAll = function() {
                    var url = "work?action=listcards";
                    //console.dir(url);
                    $http.get(url, {params: {t: "all"}}).success(function(data) {
                        if(data && data.rows) {
                            $scope.cards = data.rows;
                        }
                    });
                }
                $scope.setCard = function(card) {
                    $scope.selectCard = card;
                }
                $scope.kk = "index";
                $scope.doAll();

                $scope.setParam = function() {
                    var url = "work?action=setcard";
                    if($scope.selectCard) {
                        $http.get(url, {params: {t: "param", id: $scope.selectCard.id, name: $scope.selectCard.name, role: $scope.selectCard.role, info: $scope.selectCard.info}}).success(function(data) {
                            console.dir(data)
                            $scope.info = data;
                        });
                        
                    }
                }
            }
        </script>
        <style>
            .free {
                background: #0F0;
            }
            .crowd {
                background: #FF0;
            }
            .jam {
                background: #F00;
            }
            .unknown {
                background: #AAA;
            }
            .notEqual {
                background: #F00;
            }
            .equal {
                background: #FCF;
            }
        </style>
    </head>
    <body>

        <div class="container">


            <div ng-controller="BindState">

                <form ng-submit="setParam()" >
                    Id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<input disabled="true" ng-model="selectCard.id" /><br>
                    name:<input ng-model="selectCard.name" /><br>
                    role&nbsp;&nbsp;&nbsp;:<select ng-model="selectCard.role">
                    <option value='worker'>worker</option>
                    <option value='staff'>staff</option>
                    <option value='guard'>guard</option>
                    <option value='admin'>VIP</option>
                    </select><br>
                    info&nbsp;&nbsp;&nbsp;:<input ng-model="selectCard.info"><br>
                    <input type="submit" value="设置"/>
                </form>
                <p><p>

                <table class="table table-bordered">
                    <tr>
                        <th><a href="" ng-click="kk = 'index'; reverse=false">index</a></th>
                        <th><a href="" ng-click="kk = 'name'; reverse=!reverse">id</a></th>
                        <th><a href="" ng-click="kk = 'name'; reverse=!reverse">name</a></th>
                        <th><a href="" ng-click="kk = 'name'; reverse=!reverse">role</a></th>
                        <th><a href="" ng-click="kk = 'name'; reverse=!reverse">info</a></th>
                        <th><a href="" ng-click="kk = 'count'; reverse=!reverse">createTime</a></th>
                    </tr>
                    <tr ng-repeat="card in cards | orderBy:kk:reverse" ng-click="setCard(card)">
                        <td class="{{traffic.comp}}">{{$index + 1}}</td>
                        <td class="{{traffic.state}}">{{card.id}}</td>
                        <td class="{{traffic.comp}}">{{card.name}}</td>
                        <td class="{{traffic.comp}}">{{card.role}}</td>
                        <td class="{{traffic.comp}}">{{card.info}}</td>
                        <td class="{{traffic.comp}}">{{card.createTime}}</td>
                    </tr>
                </table>
            </div>
        </div>
    </body>
</html>